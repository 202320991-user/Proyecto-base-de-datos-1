@page
@model NorthwindWeb.Pages.Reports.HistorialClienteModel
@{
    ViewData["Title"] = "Historial de Pedidos por Cliente (SP)";
}

<h1>@ViewData["Title"]</h1>
<hr />

<form method="get" class="mb-4">
    <div class="row g-3 align-items-center">
        <div class="col-auto">
            <label for="CustomerID" class="col-form-label">ID del Cliente:</label>
        </div>
        <div class="col-auto">
            <input type="text" asp-for="CustomerID" class="form-control" required />
        </div>
        <div class="col-auto">
            <button type="submit" class="btn btn-primary">Buscar Historial</button>
        </div>
    </div>
</form>

@if (!string.IsNullOrEmpty(Model.ErrorMessage))
{
    <div class="alert alert-danger" role="alert">
        @Model.ErrorMessage
    </div>
}

@if (!string.IsNullOrEmpty(Model.CustomerID) && Model.Resultados.Any())
{
    <h3>Resultados para el Cliente: <strong>@Model.CustomerID</strong></h3>
    <table class="table table-striped table-bordered">
        <thead class="table-dark">
            <tr>
                <th>ID Pedido</th>
                <th>Fecha Pedido</th>
                <th>Total ($)</th>
                <th>Acci√≥n</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var pedido in Model.Resultados)
            {
                <tr>
                    <td>@pedido.OrderID</td>
                    <td>@pedido.FechaPedido</td>
                    <td>@pedido.Total.ToString("C2")</td>
                    <td>
                        @if (pedido.OrderID > 0)
                        {
                            <a asp-page="DetallesDePedido" asp-route-OrderID="@pedido.OrderID" class="btn btn-sm btn-info text-white">Ver Detalles (Vista)</a>
                        }
                    </td>
                </tr>
            }
        </tbody>
    </table>
}